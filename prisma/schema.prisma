generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// -----------------------------------------------------
// MODELS
// -----------------------------------------------------

// ---------------------------
// MODELS
// ---------------------------

model service_categories {
  id          BigInt                @id @default(autoincrement())
  uuid        String                @unique @default(uuid())
  name        String                @unique @db.VarChar(100)
  description String?
  created_at  DateTime              @default(now()) @db.Timestamptz
  updated_at  DateTime?             @db.Timestamptz

  // Relations
  project_categories project_categories[]
}

model clients {
  id         BigInt    @id @default(autoincrement())
  uuid       String    @unique @default(uuid())
  name       String    @unique @db.VarChar(150)
  logo       String?
  created_at DateTime? @default(now()) @db.Timestamptz
  updated_at DateTime? @db.Timestamptz

  // Relations
  projects projects[]
}

model projects {
  id          BigInt     @id @default(autoincrement())
  uuid        String     @unique @default(uuid())
  name        String
  slug        String?    @unique @db.VarChar(200)
  location    String?
  description String?
  start_date  DateTime?  @db.Date
  end_date    DateTime?  @db.Date
  year        Int?
  po_price    BigInt?
  status      String     @default("draft")
  created_at  DateTime?  @default(now()) @db.Timestamptz
  updated_at  DateTime?  @db.Timestamptz

  // Foreign Key
  clients_id  BigInt
  client      clients   @relation(fields: [clients_id], references: [id])

  // Relations
  project_images     project_images[]
  project_categories project_categories[]
}

model project_images {
  id          BigInt    @id @default(autoincrement())
  uuid        String    @unique @default(uuid())
  image_link  String?
  is_cover    Boolean   @default(false)
  caption     String?
  created_at  DateTime? @default(now()) @db.Timestamptz
  updated_at  DateTime? @db.Timestamptz

  // Foreign Key
  projects_id BigInt
  project     projects  @relation(fields: [projects_id], references: [id])

  @@unique([projects_id, image_link]) // <- unique constraint across these two columns
}

model project_categories {
  id                    BigInt           @id @default(autoincrement())
  uuid                  String           @unique @default(uuid())
  created_at            DateTime?        @default(now()) @db.Timestamptz
  updated_at            DateTime?        @db.Timestamptz

  // Foreign Keys
  projects_id           BigInt
  service_categories_id BigInt

  project           projects         @relation(fields: [projects_id], references: [id])
  service_category  service_categories @relation(fields: [service_categories_id], references: [id])

  @@unique([projects_id, service_categories_id]) // <- unique constraint across these two columns
}
